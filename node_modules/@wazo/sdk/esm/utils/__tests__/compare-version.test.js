// Can't use `semver` package as Wazo version aren't in semver format

const compareVersions = (a, b) => {
  let i;
  let diff;
  const regExStrip0 = /(\.0+)+$/;
  const segmentsA = a.replace(regExStrip0, '').split('.');
  const segmentsB = b.replace(regExStrip0, '').split('.');
  const l = Math.min(segmentsA.length, segmentsB.length);

  for (i = 0; i < l; i++) {
    diff = parseInt(segmentsA[i], 10) - parseInt(segmentsB[i], 10);
    if (diff) {
      return diff;
    }
  }
  return segmentsA.length - segmentsB.length;
};

describe('Comparing versions', () => {
  it('should compare non semver versions', () => {
    expect(compareVersions('1.0', '1.0')).toBe(0);
    expect(compareVersions('0.10', '0.9')).toBeGreaterThan(0);
    expect(compareVersions('0.10', '0.11')).toBeLessThan(0);
    expect(compareVersions('0.10', '0.1')).toBeGreaterThan(0);
    expect(compareVersions('19.10', '19.1')).toBeGreaterThan(0);
  });
});
